# ImageJ マクロ集 - 植物画像解析

このリポジトリには、植物画像の解析に使用するImageJマクロが含まれています。

## 概要

このリポジトリには以下の2つのマクロが含まれています：

1. **AreaCalculationExG.txt** - 緑色の葉面積を測定するマクロ
2. **AreaCalculationUsingBOfLabForStem.txt** - 黄色い茎の面積を測定するマクロ

## 必要なソフトウェア

- [ImageJ](https://imagej.nih.gov/ij/) または [Fiji](https://fiji.sc/)
- 画像ファイル（JPG, PNG, TIF, BMP, GIF形式対応）

## マクロの使い方

### 1. 緑色葉面積測定マクロ (AreaCalculationExG.txt)

このマクロは、ExG（Excess Green）指数を使用して緑色の葉面積を測定します。

#### 手順：

1. ImageJを起動し、マクロを読み込みます
2. マクロを実行すると、フォルダ選択ダイアログが表示されます
3. 解析したい画像が含まれるフォルダを選択します
4. 各画像に対して以下の操作を行います：
   - **スケール設定**: 10cmの基準線を描画します
   - **ROI選択**: 解析したい領域を多角形で選択します
   - **閾値調整**: 緑色の葉領域を適切に検出するよう閾値を調整します
5. 結果は `green_leaf_area_ExG.csv` ファイルに保存されます

#### 出力ファイル：
- `green_leaf_area_ExG.csv`: 各画像の緑色葉面積データ

### 2. 黄色茎面積測定マクロ (AreaCalculationUsingBOfLabForStem.txt)

このマクロは、Lab色空間のbチャンネルを使用して黄色い茎の面積を測定します。

#### 手順：

1. ImageJを起動し、マクロを読み込みます
2. マクロを実行すると、フォルダ選択ダイアログが表示されます
3. 解析したい画像が含まれるフォルダを選択します
4. 各画像に対して以下の操作を行います：
   - **スケール設定**: 10cmの基準線を描画します
   - **ROI選択**: 解析したい領域を多角形で選択します
   - **閾値調整**: 黄色い茎領域を適切に検出するよう閾値を調整します
5. 結果は `yellow_area_lab_b.csv` ファイルに保存されます

#### 出力ファイル：
- `yellow_area_lab_b.csv`: 各画像の黄色茎面積データ

## マクロの特徴

### ExGマクロの特徴
- **ExG指数**: 2G - R - B の計算式を使用
- **緑色検出**: 植物の緑色部分を効率的に検出
- **手動調整**: 閾値を手動で調整可能

### Lab bチャンネルマクロの特徴
- **Lab色空間**: より正確な色分離が可能
- **bチャンネル**: 黄色-青色軸での色分離
- **茎検出**: 黄色い茎部分の検出に特化

## 使用上の注意点

1. **スケール設定**: 必ず10cmの基準線を正確に描画してください
2. **ROI選択**: 解析したい領域のみを選択し、背景を除外してください
3. **閾値調整**: 自動閾値が適切でない場合は、手動で調整してください
4. **ファイル形式**: 対応している画像形式のみ処理可能です

## トラブルシューティング

### よくある問題と解決方法

1. **マクロが実行されない**
   - ImageJのバージョンを確認してください
   - マクロファイルが正しく読み込まれているか確認してください

2. **結果が正しくない**
   - スケール設定が正しく行われているか確認してください
   - ROI選択が適切か確認してください
   - 閾値調整を再確認してください

3. **ファイルが保存されない**
   - 出力フォルダの書き込み権限を確認してください
   - ファイル名に特殊文字が含まれていないか確認してください

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 貢献

バグ報告や機能改善の提案は、IssuesまたはPull Requestsでお願いします。

## 更新履歴

- v1.0.0: 初期バージョン
  - ExGマクロ追加
  - Lab bチャンネルマクロ追加 