# ImageJ マクロ使用ガイド

## 概要

このガイドでは、植物画像解析用ImageJマクロの詳細な使用方法について説明します。

## 前提条件

### 必要なソフトウェア
- ImageJ または Fiji
- 画像ファイル（JPG, PNG, TIF, BMP, GIF形式）

### 推奨環境
- Windows 10/11, macOS, Linux
- メモリ: 4GB以上推奨
- 画像サイズ: 1000x1000ピクセル以上推奨

## マクロの読み込み方法

### 方法1: メニューから読み込み
1. ImageJを起動
2. `Plugins` → `Macros` → `Run...`
3. マクロファイルを選択
4. `Run`をクリック

### 方法2: ドラッグ&ドロップ
1. マクロファイルをImageJウィンドウにドラッグ
2. 自動的に実行されます

## 緑色葉面積測定マクロ (AreaCalculationExG.txt)

### アルゴリズムの説明
このマクロはExG（Excess Green）指数を使用して緑色の葉面積を測定します。

**ExG指数の計算式:**
```
ExG = 2G - R - B
```

### 詳細な手順

#### 1. フォルダ選択
- マクロ実行後、解析したい画像が含まれるフォルダを選択

#### 2. スケール設定
- 各画像で10cmの基準線を描画
- 正確な測定のため、定規やスケールバーを使用

#### 3. ROI選択
- 多角形ツールで解析領域を選択
- 植物部分のみを選択し、背景を除外

#### 4. 閾値調整
- 自動閾値（Otsu法）が適用される
- 緑色の葉部分が正しく検出されているか確認

### 出力ファイル形式
```csv
File Name,Green Leaf Area
sample1,1234.567
sample2,2345.678
```

## 黄色茎面積測定マクロ (AreaCalculationUsingBOfLabForStem.txt)

### アルゴリズムの説明
このマクロはLab色空間のbチャンネルを使用して黄色い茎の面積を測定します。

### 詳細な手順

#### 1. フォルダ選択
- 緑色葉面積測定マクロと同様

#### 2. スケール設定
- 緑色葉面積測定マクロと同様

#### 3. ROI選択
- 緑色葉面積測定マクロと同様

#### 4. Lab変換とbチャンネル選択
- 画像が自動的にLab色空間に変換される
- bチャンネル（黄色-青色軸）が選択される

### 出力ファイル形式
```csv
File Name,Yellow Area (b-channel)
sample1,567.890
sample2,678.901
```

## トラブルシューティング

### よくある問題

#### 1. マクロが実行されない
**解決方法:** 最新版のImageJまたはFijiを使用

#### 2. スケール設定が正しくない
**解決方法:** 定規やスケールバーを使用して正確に10cmを測定

#### 3. ROI選択が困難
**解決方法:** 画像の明度・コントラストを調整してからROI選択

#### 4. 閾値調整が難しい
**解決方法:** 
- 照明条件を統一
- 背景を単純化
- 複数回測定して平均値を取る

## ベストプラクティス

### 画像撮影時の注意点
1. **照明条件の統一**
2. **背景の単純化**
3. **スケールバーの設置**

### 解析時の注意点
1. **複数回測定**
2. **結果の検証**
3. **データのバックアップ** 